/*!
 Realtyna Lightbox Plugin
 @Author Steve M. @ Realtyna UI Department
 @Copyright 2015 Realtyna Inc.
 */
(function(c,b,a,d){c._realtyna.fn.lightbox=function(){var p={minWidth:200,minHeight:130,maxWidth:9999,maxHeight:9999,width:800,height:500,title:"",autoSize:true,zIndex:9999,position:"center",showLoading:true,reloadPage:false,clearContent:true,loading:{color:"#000"},addTo:"body",overlayClass:"",wrapperClass:"",contentClass:"",closeClass:"",ajaxType:"POST",ajaxDataType:"html",ajaxData:d,ajaxURL:d,cssClasses:{lock:"realtyna-lightbox-lock",overlay:"realtyna-lightbox-overlay",wrap:"realtyna-lightbox-wp",title:"realtyna-lightbox-title",content:"realtyna-lightbox-cnt",close:"realtyna-lightbox-close-btn",error:"realtyna-lightbox-error",ajax:"realtyna-lightbox-ajax",placeholder:"realtyna-lightbox-placeholder",textOnlyWrap:"realtyna-lightbox-text-wrap",textOnlyContainer:"realtyna-lightbox-text-cnt",rightPos:"realtyna-lightbox-right-pos"},effects:{fadeIn:"wpl-fx-fadeIn",fadeOut:"wpl-fx-fadeOut",showOverlay:"wpl-fx-fadeIn",showBox:"wpl-fx-fadeInBottom",hideBox:"wpl-fx-fadeOutBottom"},errors:{notFound:"Selected content not found!",unexpected:"An unexpected error happen. Please try again."},callbacks:{beforeOpen:null,afterOpen:null,afterShow:null,afterClose:null}};var v=this,s=null,h=Realtyna,r={},G=null,f=null,i=null,u=false,j=false,C=false,E=null,m=null,t=null,B=null,o=null,y=null,I=null,A=null,D=null,q=null,g="inline",e={overlay:"realtyna-js-lightbox-overlay",wrap:"realtyna-js-lightbox-wrapper",content:"realtyna-js-lightbox-content",closeBtn:"realtyna-js-lightbox-close"};var l=c._realtyna.lightbox.fn={};l._beforeOpen=[];l._afterOpen=[];l._afterShow=[];l._afterClose=[];l.open=function(J){C=true;r=J.data("realtyna-lightbox-obj-opts");G=r.cssClasses;f=r.effects;i=G.placeholder;n(function(){g=w(J);switch(g){case"inline":x(J);break;case"ajax":F(J);break;default:return false}})};l.trigger=function(K){var M=r.callbacks,J=l["_"+K];if(M.hasOwnProperty(K)&&M[K]!==null){J.unshift(M[K])}for(var L=0;L<J.length;++L){J[L].call()}return true};l.getInlineOptions=function(J){if(!J){return false}return h.options2JSON(J)};l._error=function(J){I=c("<div/>").text(J).addClass(G.error);I.invisible().appendTo(B);u=true;l.trigger("beforeOpen");k();m.unbind("onShow").bind("onShow",function(){I.visible().hide().fadeIn();h.ajaxLoader.hide(o);l.trigger("afterShow");C=false;j=true})};function n(J){c("html").addClass(G.lock);E=c("<div />").attr("id",e.overlay).addClass(h.getClass(G.overlay,r.overlayClass)).css({zIndex:r.zIndex});m=c("<div />").attr("id",e.wrap).addClass(h.getClass(G.wrap,r.wrapperClass));m.appendTo(E).addClass((r.position=="center")?f.showBox:G.rightPos);t=c("<div />").attr("id",e.closeBtn).addClass(h.getClass(G.close,r.closeClass));t.hide().appendTo(m);B=c("<div />").attr("id",e.content).addClass(h.getClass(G.content,r.contentClass));B.appendTo(m);E.appendTo(r.addTo);z();l.trigger("beforeOpen");k();if(r.showLoading){o=h.ajaxLoader.show(m,"normal","center",false,r.loading.color)}J.call()}function k(){var K=h.getBrowserSizes().browser(),O,N,J,M;if(u){var L=I.css("position");I.css({position:"absolute"});if(r.autoSize){M=I.not("script, style").eq(0).outerWidth();J=I.not("script, style").eq(0).outerHeight()}else{M=r.width;J=r.height}I.css({position:(L==="static")?"":L});if(r.position=="center"){M=Math.min(M+2,r.maxWidth);J=Math.min(J+2,r.maxHeight);M=Math.max(M,r.minWidth);J=Math.max(J,r.minHeight);O=K.width/2-M/2;N=Math.max(K.height/2-J/2,40);if(!j){m.animate({left:O,top:N,width:M,height:J},450);setTimeout(function(){if(J>r.minHeight){J=(r.autoSize)?"auto":J}m.css({height:J});E.css({overflowY:"auto"});m.trigger("onShow");l.trigger("afterOpen")},600)}else{m.css({height:(r.autoSize)?"auto":J,left:O,top:N,width:M})}}else{if(r.position=="right"){m.css({left:"100%",top:0,height:"100%",width:M}).animate({marginLeft:"-"+M},450);setTimeout(function(){m.trigger("onShow");l.trigger("afterOpen")},600)}}}else{if(r.position=="center"){m.css({width:100,height:100,left:K.width/2-50,top:K.height/2-50})}else{if(r.position=="right"){m.css({width:100,height:"100%",left:"100%",top:0}).animate({marginLeft:-100},100)}}}return true}function w(K){var J;if(typeof K.attr("href")!="undefined"){J=K.attr("href")}else{if(typeof K.attr("data-realtyna-href")!="undefined"){J=K.attr("data-realtyna-href")}else{c._realtyna.lightbox.close()}}if(J.length>0){if(J[0]=="#"){return"inline"}else{return"ajax"}}}function z(){c(E).on("click.realtyna-lightbox",function(K){var J=c(K.target);if(!J.hasClass(G.wrap)&&J.parents("."+G.wrap).length==0){v.close()}});c(t).on("click.realtyna-lightbox",function(J){J.preventDefault();v.close()});c(b).on("resize.realtyna-lightbox",function(){b.resizeEvt;c(b).on("resize.realtyna-lightbox",function(){clearTimeout(b.resizeEvt);b.resizeEvt=setTimeout(function(){k()},250)})});c(a).on("keydown.realtyna-lightbox",function(J){if((J.which||J.keyCode)===27){J.preventDefault();v.close()}})}function H(){c(b).off("resize.realtyna-lightbox");c(a).off("keydown.realtyna-lightbox")}function x(K){var J=/^#[a-z]+[\w-]*$/gi;D=K.attr("href")||K.attr("data-realtyna-href");if(!J.test(D)){return}y=c(D);if(y.length===0){l._error(r.errors.notFound);return}if(!y.data(i)){y.data(i,c('<div class="'+i+'"></div>').insertAfter(y).hide())}y=y.show().invisible().detach();u=true;c(B).append(y);m.bind("onReset",function(){if(c(this).find(y).length){if(r.autoSize){m.height(y.outerHeight())}y.hide().replaceAll(y.data(i)).data(i,false);if(r.clearContent){y.html("")}}});m.bind("onShow",function(){y.visible().hide().fadeIn();t.fadeIn();h.ajaxLoader.hide(o);C=false;j=true;l.trigger("afterShow")});q=setInterval(function(){if(y.html().length>0){clearInterval(q);if(y.children().length==0){y.wrapInner('<div class="'+r.cssClasses.textOnlyContainer+'"/>');y.prepend('<h2 class="'+r.cssClasses.title+'">'+r.title+"</h2>");y.wrapInner('<div class="'+r.cssClasses.textOnlyWrap+'"/>')}if(y.find("."+r.cssClasses.title).length!=0&&y.find("."+r.cssClasses.textOnlyContainer).length==0){y.wrapInner('<div class="'+r.cssClasses.textOnlyContainer+'"/>')}if(y.find("."+r.cssClasses.title).length==0&&y.find("h2").length==0){y.prepend('<h2 class="'+r.cssClasses.title+'">'+r.title+"</h2>")}if(y.find("."+r.cssClasses.textOnlyWrap).length==0){y.wrapInner('<div class="'+r.cssClasses.textOnlyWrap+'"/>')}I=y.children();k()}},300)}function F(K){var J=K.attr("data-realtyna-lightbox-data")||{};if(typeof r.ajaxData!="undefined"){J=r.ajaxData}D=K.attr("href")||K.attr("data-realtyna-href");if(typeof r.ajaxURL!="undefined"){D=r.ajaxURL}c.ajax({type:r.ajaxType,dataType:r.ajaxDataType,url:D,data:J,error:function(L,M){l._error(r.errors.unexpected)},success:function(L,M){if(M==="success"){y=c("<div/>").addClass(G.ajax).html(L);I=y.children();u=true;l.trigger("beforeOpen");B.append(y.show().invisible());k()}}});m.bind("onShow",function(){y.visible().hide().fadeIn();t.fadeIn();h.ajaxLoader.hide(o);C=false;j=true;l.trigger("afterShow")})}this.initialize=function(J,L,K){s=K;if(typeof L!="undefined"&&L){s.each(function(){if(!c(this).data("realtyna-lightbox-obj-opts")){var M=c.extend(true,{},p,J),N=l.getInlineOptions(c(this).attr("data-realtyna-lightbox-opts"));M=c.extend(true,{},M,N);c(this).data("realtyna-lightbox-obj-opts",M);c(this).on("click.realtyna-lightbox",function(O){if(!C){O.preventDefault();l.open(c(this),O)}})}})}return this};this.open=function(K,L){var J=L||{};s=h.isQuery(K)?K:c(K);v.initialize(J,true,s);return l.open(s)};this.close=function(){if(u){m.trigger("onReset");u=false;j=false;C=false;l._beforeOpen=[];l._afterOpen=[];l._afterShow=[];l._afterClose=[];c(m).removeClass(f.showBox+" "+r.position);if(r.position=="center"){c(m).addClass(f.hideBox)}else{if(r.position=="right"){c(m).animate({marginleft:0},450)}}c(E).fadeOut(600,function(){H();c(this).remove();l.trigger("afterClose");c("html").removeClass(G.lock);if(r.reloadPage){location.reload()}});return true}return false};this.on=function(L,K){var J="_"+L;if(l.hasOwnProperty(J)){l[J].push(K)}return true}};c._realtyna.lightbox=(function(){var e;return{version:"1.9.6.5",init:function(g,f){if(!g){return false}if(!e){e=new c._realtyna.fn.lightbox();this.open=e.open;this.on=e.on;this.close=e.close}return e.initialize(f,true,g)},initObject:function(){if(!e){e=new c._realtyna.fn.lightbox();this.open=e.open;this.on=e.on;this.close=e.close}return e},open:null,on:null,close:null}})()})(jQuery,window,document);