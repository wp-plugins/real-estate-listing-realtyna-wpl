jQuery.extend({createUploadIframe:function(a,b){var c="jUploadFrame"+a,d='<iframe id="'+c+'" name="'+c+'" style="position:absolute; top:-9999px; left:-9999px"';window.ActiveXObject&&("boolean"==typeof b?d+=' src="javascript:false"':"string"==typeof b&&(d+=' src="'+b+'"'));jQuery(d+" />").appendTo(document.body);return jQuery("#"+c).get(0)},createUploadForm:function(a,b,c){var d="jUploadForm"+a;a="jUploadFile"+a;d=jQuery('<form  action="" method="POST" name="'+d+'" id="'+d+'" enctype="multipart/form-data"></form>');
if(c)for(var h in c)jQuery('<input type="hidden" name="'+h+'" value="'+c[h]+'" />').appendTo(d);jQuery('<input type="hidden" name="joomla_dont_redirect" value="yes_this_is_file_upload" />').appendTo(d);b=jQuery("#"+b);c=jQuery(b).clone();jQuery(b).attr("id",a);jQuery(b).before(c);jQuery(b).appendTo(d);jQuery(d).css("position","absolute");jQuery(d).css("top","-1200px");jQuery(d).css("left","-1200px");jQuery(d).appendTo("body");return d},ajaxFileUpload:function(a){a=jQuery.extend({},jQuery.ajaxSettings,
a);var b=(new Date).getTime(),c=jQuery.createUploadForm(b,a.fileElementId,"undefined"==typeof a.data?!1:a.data);jQuery.createUploadIframe(b,a.secureuri);var d="jUploadFrame"+b,b="jUploadForm"+b;a.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");var h=!1,e={};a.global&&jQuery.event.trigger("ajaxSend",[e,a]);var k=function(b){var f=document.getElementById(d);try{f.contentWindow?(e.responseText=f.contentWindow.document.body?f.contentWindow.document.body.innerHTML:null,e.responseXML=f.contentWindow.document.XMLDocument?
f.contentWindow.document.XMLDocument:f.contentWindow.document):f.contentDocument&&(e.responseText=f.contentDocument.document.body?f.contentDocument.document.body.innerHTML:null,e.responseXML=f.contentDocument.document.XMLDocument?f.contentDocument.document.XMLDocument:f.contentDocument.document)}catch(k){jQuery.handleError(a,e,null,k)}if(e||"timeout"==b){h=!0;var g;try{if(g="timeout"!=b?"success":"error","error"!=g){var l=jQuery.uploadHttpData(e,a.dataType);a.success&&a.success(l,g);a.global&&jQuery.event.trigger("ajaxSuccess",
[e,a])}else jQuery.handleError(a,e,g)}catch(m){g="error",jQuery.handleError(a,e,g,m)}a.global&&jQuery.event.trigger("ajaxComplete",[e,a]);a.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop");a.complete&&a.complete(e,g);jQuery(f).unbind();setTimeout(function(){try{jQuery(f).remove(),jQuery(c).remove()}catch(b){jQuery.handleError(a,e,null,b)}},100);e=null}};0<a.timeout&&setTimeout(function(){h||k("timeout")},a.timeout);try{c=jQuery("#"+b),jQuery(c).attr("action",a.url),jQuery(c).attr("method",
"POST"),jQuery(c).attr("target",d),c.encoding?jQuery(c).attr("encoding","multipart/form-data"):jQuery(c).attr("enctype","multipart/form-data"),jQuery(c).submit()}catch(l){jQuery.handleError(a,e,null,l)}jQuery("#"+d).load(k);return{abort:function(){}}},uploadHttpData:function(a,b){var c;c="xml"!=b&&b?a.responseText:a.responseXML;"script"==b&&jQuery.globalEval(c);"json"==b&&eval("data = "+c);"html"==b&&jQuery("<div>").html(c).evalScripts();return c}});
